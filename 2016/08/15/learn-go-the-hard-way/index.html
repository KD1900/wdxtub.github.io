<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.lug.ustc.edu.cn/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Go,笨鸟," />





  <link rel="alternate" href="/atom.xml" title="小土刀" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="在学习新语言这个事情上，笨办法往往是最高效的办法。效仿『笨办法学 Python』和『笨办法学 Ruby』，我来写一篇『笨办法学 Go』吧！">
<meta property="og:type" content="article">
<meta property="og:title" content="【Go 之旅】II 我的笨办法学 Go">
<meta property="og:url" content="http://wdxtub.com/2016/08/15/learn-go-the-hard-way/index.html">
<meta property="og:site_name" content="小土刀">
<meta property="og:description" content="在学习新语言这个事情上，笨办法往往是最高效的办法。效仿『笨办法学 Python』和『笨办法学 Ruby』，我来写一篇『笨办法学 Go』吧！">
<meta property="og:updated_time" content="2016-08-23T14:39:22.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【Go 之旅】II 我的笨办法学 Go">
<meta name="twitter:description" content="在学习新语言这个事情上，笨办法往往是最高效的办法。效仿『笨办法学 Python』和『笨办法学 Ruby』，我来写一篇『笨办法学 Go』吧！">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 4016951,
      author: '博主'
    }
  };
</script>

  <title> 【Go 之旅】II 我的笨办法学 Go | 小土刀 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">小土刀</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Agony is my triumph</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tech">
          <a href="/2009/09/11/tech-page" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-battery-full"></i> <br />
            
            技术
          </a>
        </li>
      
        
        <li class="menu-item menu-item-life">
          <a href="/1990/09/11/life-page" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-bolt"></i> <br />
            
            生活
          </a>
        </li>
      
        
        <li class="menu-item menu-item-booklist">
          <a href="/1997/09/11/booklist-page" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-diamond"></i> <br />
            
            书单
          </a>
        </li>
      
        
        <li class="menu-item menu-item-thanks">
          <a href="/thanks" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-gift"></i> <br />
            
            致谢
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                【Go 之旅】II 我的笨办法学 Go
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-15T19:43:14+08:00" content="2016-08-15">
              2016-08-15
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Technique/" itemprop="url" rel="index">
                    <span itemprop="name">Technique</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/15/learn-go-the-hard-way/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/15/learn-go-the-hard-way/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
              &nbsp; | &nbsp;
              <span class="page-pv"><i class="fa fa-file-o"></i>
              <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
              </span>
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在学习新语言这个事情上，笨办法往往是最高效的办法。效仿『笨办法学 Python』和『笨办法学 Ruby』，我来写一篇『笨办法学 Go』吧！</p>
<a id="more"></a>
<hr>
<h2 id="u5F00_u59CB_u4E4B_u524D"><a href="#u5F00_u59CB_u4E4B_u524D" class="headerlink" title="开始之前"></a>开始之前</h2><p>在上一篇日志中我们大概对 Go 有了基本的认识，不过还不够系统，也远达不到掌握。所以就通过简单的例子和大量的编码练习来快速入门吧！因为 Go 的语法非常简洁明了，所以重点在于用习题突出一些特性，力求简短。</p>
<p>学新语言的关键点有三个：实践、能力培养和习惯养成。这些可能要比语言的语法本身更加重要！本日志基于 Go 1.6.3，仿照『笨办法学语言』系列的模式，用闯关的方式来学习。</p>
<p>具体的安装和基础知识可以参考 <a href="http://wdxtub.com/2016/08/11/golang-first-step/">Go 快速入门</a></p>
<p>本文的配套代码可以在<a href="https://github.com/wdxtub/learn-go-the-hard-way" target="_blank" rel="external">这里</a>查阅。</p>
<h2 id="u4E60_u9898_1__u7B2C_u4E00_u4E2A_u7A0B_u5E8F"><a href="#u4E60_u9898_1__u7B2C_u4E00_u4E2A_u7A0B_u5E8F" class="headerlink" title="习题 1 第一个程序"></a>习题 1 第一个程序</h2><p>我们先从简单的弄起，按照惯例，是一个 Hello World。新建一个名为 <code>ex1.go</code> 的文件，内容为：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">    <span class="comment">// 一个变量声明</span></span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">"dawang"</span></span><br><span class="line">    <span class="comment">// 也是一个变量声明</span></span><br><span class="line">    gender := <span class="string">"male"</span></span><br><span class="line">    fmt.Println(<span class="string">"What a great day! Let's Go!"</span>)</span><br><span class="line">    fmt.Println(name + <span class="string">"'s gender is "</span> + gender) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后执行 <code>go run ex1.go</code>，可以看到结果为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex1.go</span><br><span class="line">What a great day! Let<span class="string">'s Go!</span><br><span class="line">dawang'</span>s gender is male</span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li>注释用 <code>//</code> 或 <code>/* */</code>，与 C/C++ 一样</li>
<li>变量声明用 <code>var</code> 或 <code>:=</code></li>
<li>输出语句需要引用 fmt 包</li>
<li>函数的声明用 <code>func</code>，每个程序都需要一个 <code>main</code> 函数</li>
<li>程序基本结构</li>
<li>包 Package，每个程序都需要一个 main 包</li>
</ul>
<h2 id="u4E60_u9898_2__u6570_u5B57_u548C_u6570_u5B66_u8FD0_u7B97"><a href="#u4E60_u9898_2__u6570_u5B57_u548C_u6570_u5B66_u8FD0_u7B97" class="headerlink" title="习题 2 数字和数学运算"></a>习题 2 数字和数学运算</h2><p>主要来了解一下基本的运算符使用和最关键的取地址操作，代码在 <code>ex2.go</code> 中，如下 </p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  fmt.Println(<span class="string">"Here are some basic fact:"</span>)</span><br><span class="line">  fmt.Println(<span class="string">"2 hour has"</span>, <span class="number">2</span>*<span class="number">60</span> , <span class="string">"seconds"</span>, )</span><br><span class="line">  fmt.Println(<span class="string">"Averge days in a month is"</span>, <span class="number">365.0</span> / <span class="number">12</span>)</span><br><span class="line">  fmt.Println(<span class="string">"Is it true that 3 + 2 &lt; 5 - 7?"</span>, (<span class="number">3</span> + <span class="number">2</span>) &lt; (<span class="number">5</span> - <span class="number">7</span>))</span><br><span class="line">  name := <span class="string">"wdxtub.com"</span></span><br><span class="line">  fmt.Println(<span class="string">"The address for variable 'name' is"</span>, &amp;name)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex2.go</span><br><span class="line">Here are some basic fact:</span><br><span class="line"><span class="number">2</span> hour has <span class="number">120</span> seconds</span><br><span class="line">Averge days <span class="keyword">in</span> a month is <span class="number">30.416666666666668</span></span><br><span class="line">Is it <span class="literal">true</span> that <span class="number">3</span> + <span class="number">2</span> &lt; <span class="number">5</span> - <span class="number">7</span>? <span class="literal">false</span></span><br><span class="line">The address <span class="keyword">for</span> variable <span class="string">'name'</span> is <span class="number">0</span>xc42000a410</span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li>遍历的声明</li>
<li>数值大小的比较</li>
<li>取变量的地址</li>
</ul>
<h2 id="u4E60_u9898_3__u8F93_u5165_u8F93_u51FA"><a href="#u4E60_u9898_3__u8F93_u5165_u8F93_u51FA" class="headerlink" title="习题 3 输入输出"></a>习题 3 输入输出</h2><p>输入输出主要涉及两个包，一个是 <code>fmt</code>，一个是 <code>bufio</code>。这里我们只做一个简单的任务，就是把用户输入的东西再输出出来，见 <code>ex3.go</code>，如下：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>(</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"bufio"</span></span><br><span class="line">  <span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  reader := bufio.NewReader(os.Stdin)</span><br><span class="line">  fmt.Printf(<span class="string">"Type something: "</span>)</span><br><span class="line">  <span class="keyword">if</span> line, err := reader.ReadString(<span class="string">'\n'</span>); err != <span class="constant">nil</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"Something Wrong"</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"You just typed:"</span>, line)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果为：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex3.go</span><br><span class="line">Type something: Today is a bad day?</span><br><span class="line">You just typed: Today is a bad day?</span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li><code>bufio</code> 包的简单使用</li>
</ul>
<h2 id="u4E60_u9898_4__u547D_u4EE4_u884C_u53C2_u6570"><a href="#u4E60_u9898_4__u547D_u4EE4_u884C_u53C2_u6570" class="headerlink" title="习题 4 命令行参数"></a>习题 4 命令行参数</h2><p>很多时候我们把需要配置的部分设置成命令行参数是非常方便的选择，代码可参见 <code>ex4.go</code>，如下</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"os"</span></span><br><span class="line">  <span class="string">"strings"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  name := <span class="string">"dawang"</span> <span class="comment">// 设置默认名字</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(os.Args) &gt; <span class="number">1</span> &#123;</span><br><span class="line">    <span class="comment">// os.Args[0] 是程序名，后面才是自带的参数</span></span><br><span class="line">    name = strings.Join(os.Args[<span class="number">1</span>:], <span class="string">" "</span>) <span class="comment">// 把所有除程序名之外的内容用空格拼起来</span></span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Println(<span class="string">"Hello"</span>, name)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex4.go da wang</span><br><span class="line">Hello da wang</span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li>包 os, strings 的简单尝试</li>
<li>命令行参数的获取</li>
</ul>
<h2 id="u4E60_u9898_5__u8BFB_u5199_u6587_u4EF6_u3001_u6761_u4EF6_u5224_u65AD_u548C_u51FD_u6570"><a href="#u4E60_u9898_5__u8BFB_u5199_u6587_u4EF6_u3001_u6761_u4EF6_u5224_u65AD_u548C_u51FD_u6570" class="headerlink" title="习题 5 读写文件、条件判断和函数"></a>习题 5 读写文件、条件判断和函数</h2><p>这个例子会稍微复杂一点，我们会同时涉及读写文件、条件判断和函数（这样我们才能完成一些有趣的工作），不过因为 Go 本身的设计比较简洁，所以并不会像想象中那么复杂，我们做的工作就是把一个文件的内容复制到另一个文件中，具体见 <code>ex5.go</code>，如下</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"bufio"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"io"</span></span><br><span class="line">  <span class="string">"log"</span></span><br><span class="line">  <span class="string">"os"</span></span><br><span class="line">  <span class="string">"path/filepath"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  infileName, outfileName, err := loadFromCmd()</span><br><span class="line">  <span class="keyword">if</span> err != <span class="constant">nil</span> &#123;</span><br><span class="line">    <span class="comment">// 如果从命令行中读取参数错误，则打印错误信息并退出程序</span></span><br><span class="line">    fmt.Println(err)</span><br><span class="line">    os.Exit(<span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 默认接收标准输入输出</span></span><br><span class="line">  infile, outfile := os.Stdin, os.Stdout</span><br><span class="line">  <span class="keyword">if</span> infileName != <span class="string">""</span> &#123;</span><br><span class="line">    <span class="comment">// 处理输入文件不存在的情况</span></span><br><span class="line">    <span class="keyword">if</span> infile, err = os.Open(infileName); err != <span class="constant">nil</span> &#123;</span><br><span class="line">      log.Fatal(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">defer</span> infile.Close()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> outfileName != <span class="string">""</span> &#123;</span><br><span class="line">    <span class="comment">// 处理输出文件</span></span><br><span class="line">    <span class="keyword">if</span> outfile, err = os.Create(outfileName); err != <span class="constant">nil</span> &#123;</span><br><span class="line">      log.Fatal(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">defer</span> outfile.Close()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 具体进行处理</span></span><br><span class="line">  <span class="keyword">if</span> err = process(infile, outfile); err != <span class="constant">nil</span> &#123;</span><br><span class="line">    log.Fatal(err)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从命令行读取参数</span></span><br><span class="line"><span class="keyword">func</span> loadFromCmd() (infileName, outfileName <span class="typename">string</span>, err error) &#123;</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(os.Args) &gt; <span class="number">1</span> &amp;&amp; (os.Args[<span class="number">1</span>] == <span class="string">"-h"</span> || os.Args[<span class="number">1</span>] == <span class="string">"--help"</span>)&#123;</span><br><span class="line">    err = fmt.Errorf(<span class="string">"usage: %s [&lt;] infile.txt [&gt;] outfile.txt"</span>, filepath.Base(os.Args[<span class="number">0</span>]))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>, <span class="string">""</span>, err</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(os.Args) &gt; <span class="number">1</span> &#123;</span><br><span class="line">    infileName = os.Args[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(os.Args) &gt; <span class="number">2</span> &#123;</span><br><span class="line">      outfileName = os.Args[<span class="number">2</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> infileName != <span class="string">""</span> &amp;&amp; infileName == outfileName &#123;</span><br><span class="line">    log.Fatal(<span class="string">"won't overwrite the infile"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> infileName, outfileName, <span class="constant">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理文件</span></span><br><span class="line"><span class="keyword">func</span> process(infile io.Reader, outfile io.Writer)(err error) &#123;</span><br><span class="line">  reader := bufio.NewReader(infile)</span><br><span class="line">  writer := bufio.NewWriter(outfile)</span><br><span class="line">  <span class="keyword">defer</span> <span class="keyword">func</span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> err == <span class="constant">nil</span> &#123;</span><br><span class="line">      err = writer.Flush()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;()</span><br><span class="line"></span><br><span class="line">  eof := <span class="constant">false</span></span><br><span class="line">  <span class="keyword">for</span> !eof &#123;</span><br><span class="line">    <span class="keyword">var</span> line <span class="typename">string</span></span><br><span class="line">    line, err = reader.ReadString(<span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">      err = <span class="constant">nil</span></span><br><span class="line">      eof = <span class="constant">true</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="constant">nil</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> err</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> _, err = writer.WriteString(line); err != <span class="constant">nil</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> err</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="constant">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里引入了几个我们之前没有见过的包，简单介绍一下：</p>
<ul>
<li><code>bufio</code> 带缓冲的 io 处理</li>
<li><code>io</code> 底层 io 功能</li>
<li><code>log</code> 日志相关</li>
</ul>
<p><strong>知识点</strong></p>
<ul>
<li>defer 语句会在包含它的函数执行完成之后执行（延迟执行），通常可以用作收尾工作</li>
<li>利用函数分离长串代码，一个函数只做一个事情</li>
<li>利用返回值来做检查</li>
</ul>
<h2 id="u4E60_u9898_6__u679A_u4E3E_u7C7B_u578B"><a href="#u4E60_u9898_6__u679A_u4E3E_u7C7B_u578B" class="headerlink" title="习题 6 枚举类型"></a>习题 6 枚举类型</h2><p>与枚举类型配合有一个变量叫做 <code>iota</code>，每次调用的时候其值都会默认加一，下面是一个很有趣的例子，需要大家仔细感受一下，见 <code>ex6.go</code>，如下</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>(</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"strings"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> BitFlag <span class="typename">int</span></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">  Active BitFlag = <span class="number">1</span> &lt;&lt; <span class="constant">iota</span> <span class="comment">// 1 &lt;&lt; 0 == 1</span></span><br><span class="line">  Send <span class="comment">// 隐式设置为 1 &lt;&lt; iota，所以 1 &lt;&lt; 1 == 2</span></span><br><span class="line">  Receive <span class="comment">// 隐式设置为 1 &lt;&lt; iota，所以 1 &lt;&lt; 2 == 4</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> (flag BitFlag) String() <span class="typename">string</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> flags []<span class="typename">string</span></span><br><span class="line">  <span class="keyword">if</span> flag &amp; Active == Active &#123;</span><br><span class="line">    flags = <span class="built_in">append</span>(flags, <span class="string">"Active"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> flag &amp; Send == Send &#123;</span><br><span class="line">    flags = <span class="built_in">append</span>(flags, <span class="string">"Send"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> flag &amp; Receive == Receive &#123;</span><br><span class="line">    flags = <span class="built_in">append</span>(flags, <span class="string">"Receive"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(flags) &gt; <span class="number">0</span> &#123; <span class="comment">// 这里，int(flag) 用于防止无限循环，至关重要</span></span><br><span class="line">    <span class="keyword">return</span> fmt.Sprintf(<span class="string">"%d(%s)"</span>, <span class="typename">int</span>(flag), strings.Join(flags, <span class="string">"|"</span>))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"0()"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  <span class="keyword">var</span> flag = Active | Send</span><br><span class="line">  fmt.Println(BitFlag(<span class="number">0</span>), Active, Send, flag, Receive, flag|Receive)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex6.go</span><br><span class="line"><span class="number">0</span>() <span class="number">1</span>(Active) <span class="number">2</span>(Send) <span class="number">3</span>(Active|Send) <span class="number">4</span>(Receive) <span class="number">7</span>(Active|Send|Receive)</span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li><code>iota</code> 的用法</li>
<li>如何给指定类型重写 <code>String()</code> 方法来自定义输出</li>
</ul>
<h2 id="u4E60_u9898_7__u503C_u4E0E_u5F15_u7528"><a href="#u4E60_u9898_7__u503C_u4E0E_u5F15_u7528" class="headerlink" title="习题 7 值与引用"></a>习题 7 值与引用</h2><p>关于值和引用前面已经说过，这里需要注意的是数组在 Go 中是按值传递的，所以传递一个大数组的代价非常大，不过我们通常用切片来进行代替，传递切片的成本与字符串差不多。</p>
<p>这里我们分别用两种方式来传递参数，具体见 <code>ex7.go</code>，如下</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  i := <span class="number">9</span></span><br><span class="line">  j := <span class="number">5</span></span><br><span class="line">  product := <span class="number">0</span></span><br><span class="line">  fmt.Println(<span class="string">"Origin Data:"</span>, i, j)</span><br><span class="line">  swapAndProduct1(&amp;i, &amp;j, &amp;product)</span><br><span class="line">  fmt.Println(<span class="string">"Swapped1:"</span>, i, j, product)</span><br><span class="line"></span><br><span class="line">  i = <span class="number">9</span></span><br><span class="line">  j = <span class="number">5</span></span><br><span class="line">  i, j, product = swapAndProduct2(i, j)</span><br><span class="line">  fmt.Println(<span class="string">"Swapped2:"</span>, i, j, product)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> swapAndProduct1(x, y, product *<span class="typename">int</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> *x &gt; *y &#123;</span><br><span class="line">    *x, *y = *y, *x</span><br><span class="line">  &#125;</span><br><span class="line">  *product = *x * *y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> swapAndProduct2(x, y <span class="typename">int</span>) (<span class="typename">int</span>, <span class="typename">int</span>, <span class="typename">int</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> x &gt; y &#123;</span><br><span class="line">    x, y = y, x</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x, y, x * y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex7.go</span><br><span class="line">Origin Data: <span class="number">9</span> <span class="number">5</span></span><br><span class="line">Swapped1: <span class="number">5</span> <span class="number">9</span> <span class="number">45</span></span><br><span class="line">Swapped2: <span class="number">5</span> <span class="number">9</span> <span class="number">45</span></span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li>两种交换方式看起来结果一样，不过第二种不是原地交换，这里需要注意一下</li>
<li>不过第二种不需要操心太多的 <code>*</code>，可读性更好</li>
</ul>
<h2 id="u4E60_u9898_8__u6570_u7EC4_u4E0E_u5207_u7247"><a href="#u4E60_u9898_8__u6570_u7EC4_u4E0E_u5207_u7247" class="headerlink" title="习题 8 数组与切片"></a>习题 8 数组与切片</h2><p>Go 语言的数组是一个定长的序列，其中的元素类型相同，数组的创建语法和切片有些类似，注意要区别一下</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 数组声明</span></span><br><span class="line">[length]Type</span><br><span class="line">[N]Type&#123;value1, value2, ..., valueN&#125;</span><br><span class="line">[...]Type&#123;value1, value2, ..., valueN&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 切片声明</span></span><br><span class="line"><span class="built_in">make</span>([]Type, length, capacity)</span><br><span class="line"><span class="built_in">make</span>([]Type, length)</span><br><span class="line">[]Type&#123;&#125;</span><br><span class="line">[]Type&#123;value1, value2, ..., valueN&#125;</span><br></pre></td></tr></table></figure>
<p>看到了吗，唯一的区别其实在于 <code>[]</code> 中的内容，如果有，则是数组，如果没有，则是切片。具体的例子可见 <code>ex8.go</code>，如下：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>(</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  <span class="comment">// 声明数组</span></span><br><span class="line">  cities := [...]<span class="typename">string</span>&#123;<span class="string">"Shanghai"</span>, <span class="string">"Guangzhou"</span>, <span class="string">"Shenzhen"</span>, <span class="string">"Beijing"</span>&#125;</span><br><span class="line">  fmt.Printf(<span class="string">"%-8T %2d %q\n"</span>, cities, <span class="built_in">len</span>(cities), cities)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 声明切片</span></span><br><span class="line">  s := []<span class="typename">string</span>&#123;<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>, <span class="string">"F"</span>, <span class="string">"G"</span>&#125;</span><br><span class="line">  t := s[:<span class="number">5</span>]</span><br><span class="line">  u := s[<span class="number">3</span>:<span class="built_in">len</span>(s)-<span class="number">1</span>]</span><br><span class="line">  fmt.Println(s, t, u)</span><br><span class="line">  u[<span class="number">1</span>] = <span class="string">"x"</span></span><br><span class="line">  fmt.Println(s, t, u)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 遍历切片</span></span><br><span class="line">  <span class="keyword">for</span> i, letter := <span class="keyword">range</span> s &#123;</span><br><span class="line">    fmt.Println(i, letter)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex9.go</span><br><span class="line">[<span class="number">4</span>]string  <span class="number">4</span> [<span class="string">"Shanghai"</span> <span class="string">"Guangzhou"</span> <span class="string">"Shenzhen"</span> <span class="string">"Beijing"</span>]</span><br><span class="line">[A B C D E F G] [A B C D E] [D E F]</span><br><span class="line">[A B C D x F G] [A B C D x] [D x F]</span><br><span class="line"><span class="number">0</span> A</span><br><span class="line"><span class="number">1</span> B</span><br><span class="line"><span class="number">2</span> C</span><br><span class="line"><span class="number">3</span> D</span><br><span class="line"><span class="number">4</span> x</span><br><span class="line"><span class="number">5</span> F</span><br><span class="line"><span class="number">6</span> G</span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li>数组和切片的区别</li>
<li>数组和切片的基本使用</li>
</ul>
<h2 id="u4E60_u9898_9__u6620_u5C04"><a href="#u4E60_u9898_9__u6620_u5C04" class="headerlink" title="习题 9 映射"></a>习题 9 映射</h2><p>简单来说就是字典，用来保存键值对，先来说说基本用法</p>
<ul>
<li><code>m[k] = v</code> 基本的赋值，会覆盖</li>
<li><code>Delete(m, k)</code> 从 m 中删除 k，如果 k 不存在，啥都不发生</li>
<li><code>v := m[k]</code> 取值，如果 k 不存在，v 为 0</li>
<li><code>v, found := m[k]</code> 取值，如果存在，值保存在 v 中，found 为 true，反之，v 为 0 且 found 为 false</li>
<li><code>len(m)</code> 返回 m 中键值对的数量</li>
</ul>
<p>创建映射的语法为</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建映射</span></span><br><span class="line"><span class="built_in">make</span>(<span class="keyword">map</span>[KeyType]ValueType, initialCapacity)</span><br><span class="line"><span class="built_in">make</span>(<span class="keyword">map</span>[KeyType]ValueType)</span><br><span class="line"><span class="keyword">map</span>[KeyType]ValueType&#123;&#125;</span><br><span class="line"><span class="keyword">map</span>[KeyType]ValueType&#123;key1: value1, key2: value2, ..., keyN: valueN&#125;</span><br></pre></td></tr></table></figure>
<p>具体的例子可参见 <code>ex9.go</code>，如下</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>  (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  massForPlanet := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="typename">string</span>]<span class="typename">float64</span>)</span><br><span class="line">  massForPlanet[<span class="string">"Mercury"</span>] = <span class="number">0.06</span></span><br><span class="line">  massForPlanet[<span class="string">"Venus"</span>] = <span class="number">0.82</span></span><br><span class="line">  massForPlanet[<span class="string">"Earth"</span>] = <span class="number">1.00</span></span><br><span class="line">  massForPlanet[<span class="string">"Mars"</span>] = <span class="number">0.11</span></span><br><span class="line">  fmt.Println(massForPlanet)</span><br><span class="line">  massForPlanet[<span class="string">"Jupiter"</span>] = <span class="number">317.82</span></span><br><span class="line">  massForPlanet[<span class="string">"Saturn"</span>] = <span class="number">95.16</span></span><br><span class="line">  massForPlanet[<span class="string">"Uranus"</span>] = <span class="number">14.371</span></span><br><span class="line">  massForPlanet[<span class="string">"Neptune"</span>] = <span class="number">17.147</span></span><br><span class="line">  fmt.Println(massForPlanet)</span><br><span class="line">  big := <span class="string">"Jupiter"</span></span><br><span class="line">  fmt.Println(big, massForPlanet[big])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li>映射的基本使用</li>
</ul>
<h2 id="u4E60_u9898_10_Switch__u8BED_u53E5"><a href="#u4E60_u9898_10_Switch__u8BED_u53E5" class="headerlink" title="习题 10 Switch 语句"></a>习题 10 Switch 语句</h2><p>Go 中有两种类型的 switch 语句，可以用表达式或者类型本身来进行分支跳转，另外 Go 的 switch 语句是不会自动向下执行的，如果需要的话，就得加上 <code>fallthrough</code> 关键词。Go 语言的表达式 switch 语句非常有用，很多时候可以代替 if 语句，还更加紧凑。</p>
<p>两种类型的示例可见 <code>ex10.go</code>，如下：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>(</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  <span class="comment">// 表达式 switch</span></span><br><span class="line">  <span class="keyword">var</span> suffix = <span class="string">".gz"</span></span><br><span class="line">  <span class="keyword">var</span> result <span class="typename">string</span></span><br><span class="line">  <span class="keyword">switch</span> suffix &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">".gz"</span>:</span><br><span class="line">    result = <span class="string">"This is a Gzip file"</span></span><br><span class="line">  <span class="keyword">case</span> <span class="string">".tar"</span>, <span class="string">".tar.gz"</span>, <span class="string">".tgz"</span>:</span><br><span class="line">    result = <span class="string">"This is a Tar file"</span></span><br><span class="line">  <span class="keyword">case</span> <span class="string">".zip"</span>:</span><br><span class="line">    result = <span class="string">"This is a Zip file"</span></span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Println(result)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 类型 switch</span></span><br><span class="line">  classifier(<span class="number">5</span>, -<span class="number">17.9</span>, <span class="string">"LOL"</span>, <span class="constant">nil</span>, <span class="constant">true</span>, <span class="built_in">complex</span>(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> classifier(items...<span class="keyword">interface</span>&#123;&#125;) &#123;</span><br><span class="line">  <span class="keyword">for</span> i, x := <span class="keyword">range</span> items &#123;</span><br><span class="line">    <span class="keyword">switch</span> x.(<span class="keyword">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="typename">bool</span>:</span><br><span class="line">      fmt.Printf(<span class="string">"Param #%d is a bool\n"</span>, i)</span><br><span class="line">    <span class="keyword">case</span> <span class="typename">float64</span>:</span><br><span class="line">      fmt.Printf(<span class="string">"Param #%d is a float64\n"</span>, i)</span><br><span class="line">    <span class="keyword">case</span> <span class="typename">int</span>, <span class="typename">int8</span>, <span class="typename">int16</span>, <span class="typename">int32</span>, <span class="typename">int64</span>:</span><br><span class="line">      fmt.Printf(<span class="string">"Param #%d is a int\n"</span>, i)</span><br><span class="line">    <span class="keyword">case</span> <span class="typename">uint</span>, <span class="typename">uint8</span>, <span class="typename">uint16</span>, <span class="typename">uint32</span>, <span class="typename">uint64</span>:</span><br><span class="line">      fmt.Printf(<span class="string">"Param #%d is an unsigned int\n"</span>, i)</span><br><span class="line">    <span class="keyword">case</span> <span class="constant">nil</span>:</span><br><span class="line">      fmt.Printf(<span class="string">"Param #%d is nil\n"</span>, i)</span><br><span class="line">    <span class="keyword">case</span> <span class="typename">string</span>:</span><br><span class="line">      fmt.Printf(<span class="string">"Param #%d is a string\n"</span>, i)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      fmt.Printf(<span class="string">"Param #%d is unknown type\n"</span>, i)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex10.go</span><br><span class="line">This is a Gzip file</span><br><span class="line">Param <span class="comment">#0 is a int</span></span><br><span class="line">Param <span class="comment">#1 is a float64</span></span><br><span class="line">Param <span class="comment">#2 is a string</span></span><br><span class="line">Param <span class="comment">#3 is nil</span></span><br><span class="line">Param <span class="comment">#4 is a bool</span></span><br><span class="line">Param <span class="comment">#5 is unknown type</span></span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li>可变参数列表的声明</li>
<li><code>interface{}</code> 空接口的使用</li>
<li>两种类型的 switch 语句</li>
<li>for 循环语句</li>
</ul>
<h2 id="u4E60_u9898_11__u5E76_u53D1"><a href="#u4E60_u9898_11__u5E76_u53D1" class="headerlink" title="习题 11 并发"></a>习题 11 并发</h2><p>Go 语言中可以轻松创建 goroutine，可以利用 channel 进行类型安全的单向/双向通信或同步 goroutine，因为其机制是传递数据而非共享数据。这里我们用一个坐标系转换的例子来说明，具体可见 <code>ex11.go</code>，如下</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>(</span><br><span class="line">  <span class="string">"bufio"</span></span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"math"</span></span><br><span class="line">  <span class="string">"os"</span></span><br><span class="line">  <span class="string">"runtime"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> polar <span class="keyword">struct</span>&#123;</span><br><span class="line">  radius <span class="typename">float64</span></span><br><span class="line">  theta <span class="typename">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> cartesian <span class="keyword">struct</span> &#123;</span><br><span class="line">  x <span class="typename">float64</span></span><br><span class="line">  y <span class="typename">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> prompt = <span class="string">"输入一个弧长 radius 和角度 theta，例如 12.5 90，或 %s 来退出"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> init() &#123;</span><br><span class="line">  <span class="keyword">if</span> runtime.GOOS == <span class="string">"windows"</span> &#123;</span><br><span class="line">    prompt = fmt.Sprintf(prompt, <span class="string">"Ctrl+Z, Enter"</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    prompt = fmt.Sprintf(prompt, <span class="string">"Ctrl+D"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  questions := <span class="built_in">make</span>(<span class="keyword">chan</span> polar)</span><br><span class="line">  <span class="keyword">defer</span> <span class="built_in">close</span>(questions)</span><br><span class="line">  answers := createSolver(questions)</span><br><span class="line">  <span class="keyword">defer</span> <span class="built_in">close</span>(answers)</span><br><span class="line">  interact(questions, answers)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> createSolver(questions <span class="keyword">chan</span> polar) <span class="keyword">chan</span> cartesian &#123;</span><br><span class="line">  answers := <span class="built_in">make</span>(<span class="keyword">chan</span> cartesian)</span><br><span class="line">  <span class="keyword">go</span> <span class="keyword">func</span>() &#123;</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">      polarCoord := &lt;-questions</span><br><span class="line">      theta := polarCoord.theta * math.Pi / <span class="number">180.0</span></span><br><span class="line">      x := polarCoord.radius * math.Cos(theta)</span><br><span class="line">      y := polarCoord.radius * math.Sin(theta)</span><br><span class="line">      answers &lt;- cartesian&#123;x, y&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;()</span><br><span class="line">  <span class="keyword">return</span> answers</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = <span class="string">"Polar radius=%.02f theta=%.02f degree -&gt; Cartesian x=%.02f y=%.02f\n"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> interact(questions <span class="keyword">chan</span> polar, answers <span class="keyword">chan</span> cartesian) &#123;</span><br><span class="line">  reader := bufio.NewReader(os.Stdin)</span><br><span class="line">  fmt.Println(prompt)</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"Radius and angle: "</span>)</span><br><span class="line">    line, err := reader.ReadString(<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> err != <span class="constant">nil</span> &#123;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> radius, theta <span class="typename">float64</span></span><br><span class="line">    <span class="keyword">if</span> _, err := fmt.Sscanf(line, <span class="string">"%f %f"</span>, &amp;radius, &amp;theta); err != <span class="constant">nil</span> &#123;</span><br><span class="line">      fmt.Println(os.Stderr, <span class="string">"invalid input"</span>)</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">    questions &lt;- polar&#123;radius, theta&#125;</span><br><span class="line">    coord := &lt;-answers</span><br><span class="line">    fmt.Printf(result, radius, theta, coord.x, coord.y)</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Println()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>具体的输出为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex11.go</span><br><span class="line">输入一个弧长 radius 和角度 theta，例如 <span class="number">12.5</span> <span class="number">90</span>，或 Ctrl+D 来退出</span><br><span class="line">Radius and angle: <span class="number">12.5</span> <span class="number">90</span></span><br><span class="line">Polar radius=<span class="number">12.50</span> theta=<span class="number">90.00</span> degree -&gt; Cartesian x=<span class="number">0.00</span> y=<span class="number">12.50</span></span><br><span class="line">Radius and angle: ^D</span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li>通过 struct 定义结构体</li>
<li><code>runtime</code> 包提供运行时控制，比方说确定程序运行的平台</li>
<li><code>func init()</code> 不能显式调用，会在执行 <code>main()</code> 之前自动执行</li>
<li>通道的行为跟先进先出队列一致，可以堵塞，能够以此来进行同步</li>
<li>goroutine 执行机制的简单理解</li>
</ul>
<h2 id="u4E60_u9898_12_Select__u8BED_u53E5"><a href="#u4E60_u9898_12_Select__u8BED_u53E5" class="headerlink" title="习题 12 Select 语句"></a>习题 12 Select 语句</h2><p>在一个 Select 语句中，Go 语言会按顺序从头至尾评估每一个发送和接收语句，如果有一条可以执行，那就执行，不然如果没有 default 语句，就阻塞，下面是一个简单的模拟骰子的例子，具体见 <code>ex12.go</code>，如下：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>(</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"math/rand"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  channels := <span class="built_in">make</span>([]<span class="keyword">chan</span> <span class="typename">bool</span>, <span class="number">6</span>)</span><br><span class="line">  <span class="keyword">for</span> i := <span class="keyword">range</span> channels &#123;</span><br><span class="line">    channels[i] = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="typename">bool</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">go</span> <span class="keyword">func</span>() &#123;</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">      channels[rand.Intn(<span class="number">6</span>)] &lt;- <span class="constant">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">36</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">var</span> x <span class="typename">int</span></span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> &lt;-channels[<span class="number">0</span>]:</span><br><span class="line">      x = <span class="number">1</span></span><br><span class="line">    <span class="keyword">case</span> &lt;-channels[<span class="number">1</span>]:</span><br><span class="line">      x = <span class="number">2</span></span><br><span class="line">    <span class="keyword">case</span> &lt;-channels[<span class="number">2</span>]:</span><br><span class="line">      x = <span class="number">3</span></span><br><span class="line">    <span class="keyword">case</span> &lt;-channels[<span class="number">3</span>]:</span><br><span class="line">      x = <span class="number">4</span></span><br><span class="line">    <span class="keyword">case</span> &lt;-channels[<span class="number">4</span>]:</span><br><span class="line">      x = <span class="number">5</span></span><br><span class="line">    <span class="keyword">case</span> &lt;-channels[<span class="number">5</span>]:</span><br><span class="line">      x = <span class="number">6</span></span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">"%d "</span>, x)</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Println()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex12.go</span><br><span class="line"><span class="number">6</span> <span class="number">4</span> <span class="number">6</span> <span class="number">6</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">5</span> <span class="number">1</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span> <span class="number">6</span> <span class="number">5</span> <span class="number">3</span> <span class="number">4</span> <span class="number">6</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">1</span> <span class="number">3</span> <span class="number">5</span> <span class="number">4</span> <span class="number">2</span> <span class="number">2</span> <span class="number">5</span> <span class="number">1</span> <span class="number">4</span> <span class="number">2</span> <span class="number">1</span> <span class="number">6</span> <span class="number">6</span> <span class="number">4</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li>生成随机数的方法</li>
<li>select 语句的基本用法</li>
</ul>
<h2 id="u4E60_u9898_13__u9519_u8BEF_u4E0E_u5F02_u5E38"><a href="#u4E60_u9898_13__u9519_u8BEF_u4E0E_u5F02_u5E38" class="headerlink" title="习题 13 错误与异常"></a>习题 13 错误与异常</h2><p>通过内置的 <code>panic()</code> 和 <code>recover()</code> 函数，Go 提供了一套异常处理机制，虽然可以以此实现通用的异常处理机制，但并不推荐这样做。</p>
<p>Go 将错误和异常两者区分对待。错误是指可能出错的东西，程序需要以优雅的方式将其处理。而异常是指『不可能』发生的事情。</p>
<p>Go 语言中处理错误的惯用法是将错误以函数或者方法最后一个返回值的形式将其返回，并总是在调用它的地方检查返回的错误值。</p>
<p>本例来自 <a href="http://xhrwang.me/2014/12/30/golang-fundamentals-9-error-panic-recover.html" target="_blank" rel="external">Golang 语言基础之九： error, panic, recover</a>，见 <code>ex13.go</code>，如下：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>(</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 最简单的例子</span></span><br><span class="line"><span class="keyword">func</span> SimplePanicRecover() &#123;</span><br><span class="line">  <span class="keyword">defer</span> <span class="keyword">func</span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="constant">nil</span> &#123;</span><br><span class="line">      fmt.Println(<span class="string">"Panic info is: "</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;()</span><br><span class="line">  <span class="built_in">panic</span>(<span class="string">"SimplePanicRecover function panic-ed!"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当 defer 中也调用了 panic 函数时，最后被调用的 panic 函数的参数会被后面的 recover 函数获取到</span></span><br><span class="line"><span class="comment">// 一个函数中可以定义多个 defer 函数，按照 FILO 的规则执行</span></span><br><span class="line"><span class="keyword">func</span> MultiPanicRecover() &#123;</span><br><span class="line">  <span class="keyword">defer</span> <span class="keyword">func</span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="constant">nil</span> &#123;</span><br><span class="line">      fmt.Println(<span class="string">"Panic info is: "</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;()</span><br><span class="line">  <span class="keyword">defer</span> <span class="keyword">func</span>() &#123;</span><br><span class="line">    <span class="built_in">panic</span>(<span class="string">"MultiPanicRecover defer inner panic"</span>)</span><br><span class="line">  &#125;()</span><br><span class="line">  <span class="keyword">defer</span> <span class="keyword">func</span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="constant">nil</span> &#123;</span><br><span class="line">      fmt.Println(<span class="string">"Panic info is: "</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;()</span><br><span class="line">  <span class="built_in">panic</span>(<span class="string">"MultiPanicRecover function panic-ed!"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// recover 函数只有在 defer 函数中被直接调用的时候才可以获取 panic 的参数</span></span><br><span class="line"><span class="keyword">func</span> RecoverPlaceTest() &#123;</span><br><span class="line">  <span class="comment">// 下面一行代码中 recover 函数会返回 nil，但也不影响程序运行</span></span><br><span class="line">  <span class="keyword">defer</span> <span class="built_in">recover</span>()</span><br><span class="line">  <span class="comment">// recover 函数返回 nil</span></span><br><span class="line">  <span class="keyword">defer</span> fmt.Println(<span class="string">"recover() is: "</span>, <span class="built_in">recover</span>())</span><br><span class="line">  <span class="keyword">defer</span> <span class="keyword">func</span>() &#123;</span><br><span class="line">    <span class="keyword">func</span>() &#123;</span><br><span class="line">      <span class="comment">// 由于不是在 defer 调用函数中直接调用 recover 函数，recover 函数会返回 nil</span></span><br><span class="line">      <span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="constant">nil</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"Panic info is: "</span>, err)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">  &#125;()</span><br><span class="line">  <span class="keyword">defer</span> <span class="keyword">func</span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="constant">nil</span> &#123;</span><br><span class="line">      fmt.Println(<span class="string">"Panic info is: "</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;()</span><br><span class="line">  <span class="built_in">panic</span>(<span class="string">"RecoverPlaceTest function panic-ed!"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果函数没有 panic，调用 recover 函数不会获取到任何信息，也不会影响当前进程。</span></span><br><span class="line"><span class="keyword">func</span> NoPanicButHasRecover() &#123;</span><br><span class="line">  <span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="constant">nil</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"NoPanicButHasRecover Panic info is: "</span>, err)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"NoPanicButHasRecover Panic info is: "</span>, err)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个调用 recover 函数的函数</span></span><br><span class="line"><span class="keyword">func</span> CallRecover() &#123;</span><br><span class="line">  <span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="constant">nil</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"Panic info is: "</span>, err)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义个函数，在其中 defer 另一个调用了 recover 函数的函数</span></span><br><span class="line"><span class="keyword">func</span> RecoverInOutterFunc() &#123;</span><br><span class="line">  <span class="keyword">defer</span> CallRecover()</span><br><span class="line">  <span class="built_in">panic</span>(<span class="string">"RecoverInOutterFunc function panic-ed!"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  SimplePanicRecover()</span><br><span class="line">  MultiPanicRecover()</span><br><span class="line">  RecoverPlaceTest()</span><br><span class="line">  NoPanicButHasRecover()</span><br><span class="line">  RecoverInOutterFunc()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex13.go</span><br><span class="line">Panic info is:  SimplePanicRecover <span class="keyword">function</span> panic-ed!</span><br><span class="line">Panic info is:  MultiPanicRecover <span class="keyword">function</span> panic-ed!</span><br><span class="line">Panic info is:  MultiPanicRecover defer inner panic</span><br><span class="line">Panic info is:  RecoverPlaceTest <span class="keyword">function</span> panic-ed!</span><br><span class="line">recover() is:  &lt;nil&gt;</span><br><span class="line">NoPanicButHasRecover Panic info is:  &lt;nil&gt;</span><br><span class="line">Panic info is:  RecoverInOutterFunc <span class="keyword">function</span> panic-ed!</span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li>panic 的机制</li>
<li>recover 的机制</li>
</ul>
<h2 id="u4E60_u9898_14_Interface"><a href="#u4E60_u9898_14_Interface" class="headerlink" title="习题 14 Interface"></a>习题 14 Interface</h2><p>关于接口的内容比较特别，因为 Go 中没有类的概念，而且是通过 interface 类型转换支持在动态类型语言中常见的 鸭子类型 达到运行时多态的效果。</p>
<p>更多详情请参考 <a href="http://xhrwang.me/2014/12/29/golang-fundamentals-8-interface.html" target="_blank" rel="external">Golang 语言基础之八： interface</a>，代码在 <code>ex14.go</code> 中（同样来自 <a href="http://xhrwang.me/2014/12/29/golang-fundamentals-8-interface.html" target="_blank" rel="external">Golang 语言基础之八： interface</a>），如下</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义接口类型 PeopleGetter 包含获取基本信息的方法</span></span><br><span class="line"><span class="keyword">type</span> PeopleGetter <span class="keyword">interface</span> &#123;</span><br><span class="line">  GetName() <span class="typename">string</span></span><br><span class="line">  GetAge() <span class="typename">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义接口类型 EmployeeGetter 包含获取薪水的方法</span></span><br><span class="line"><span class="comment">// EmployeeGetter 接口中嵌入了 PeopleGetter 接口，前者将获取后者的所有方法</span></span><br><span class="line"><span class="keyword">type</span> EmployeeGetter <span class="keyword">interface</span> &#123;</span><br><span class="line">  PeopleGetter</span><br><span class="line">  GetSalary() <span class="typename">int</span></span><br><span class="line">  Help()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义结构 Employee</span></span><br><span class="line"><span class="keyword">type</span> Employee <span class="keyword">struct</span> &#123;</span><br><span class="line">  name   <span class="typename">string</span></span><br><span class="line">  age    <span class="typename">int</span></span><br><span class="line">  salary <span class="typename">int</span></span><br><span class="line">  gender <span class="typename">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义结构 Employee 的方法</span></span><br><span class="line"><span class="keyword">func</span> (self *Employee) GetName() <span class="typename">string</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> self.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> (self *Employee) GetAge() <span class="typename">int</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> self.age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> (self *Employee) GetSalary() <span class="typename">int</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> self.salary</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> (self *Employee) Help() &#123;</span><br><span class="line">  fmt.Println(<span class="string">"This is help info."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 匿名接口可以被用作变量或者结构属性类型</span></span><br><span class="line"><span class="keyword">type</span> Man <span class="keyword">struct</span> &#123;</span><br><span class="line">  gender <span class="keyword">interface</span> &#123;</span><br><span class="line">    GetGender() <span class="typename">string</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> (self *Employee) GetGender() <span class="typename">string</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> self.gender</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义执行回调函数的接口</span></span><br><span class="line"><span class="keyword">type</span> Callbacker <span class="keyword">interface</span> &#123;</span><br><span class="line">  Execute()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义函数类型 func() 的新类型 CallbackFunc</span></span><br><span class="line"><span class="keyword">type</span> CallbackFunc <span class="keyword">func</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 CallbackFunc 的 Execute() 方法</span></span><br><span class="line"><span class="keyword">func</span> (self CallbackFunc) Execute() &#123; self() &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> main() &#123;</span><br><span class="line">  <span class="comment">// 空接口的使用，空接口类型的变量可以保存任何类型的值</span></span><br><span class="line">  <span class="comment">// 空格口类型的变量非常类似于弱类型语言中的变量</span></span><br><span class="line">  <span class="keyword">var</span> varEmptyInterface <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">  fmt.Printf(<span class="string">"varEmptyInterface is of type %T\n"</span>, varEmptyInterface)</span><br><span class="line">  varEmptyInterface = <span class="number">100</span></span><br><span class="line">  fmt.Printf(<span class="string">"varEmptyInterface is of type %T\n"</span>, varEmptyInterface)</span><br><span class="line">  varEmptyInterface = <span class="string">"Golang"</span></span><br><span class="line">  fmt.Printf(<span class="string">"varEmptyInterface is of type %T\n"</span>, varEmptyInterface)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Employee 实现了 PeopleGetter 和 EmployeeGetter 两个接口</span></span><br><span class="line">  varEmployee := Employee&#123;</span><br><span class="line">    name:   <span class="string">"Jack Ma"</span>,</span><br><span class="line">    age:    <span class="number">50</span>,</span><br><span class="line">    salary: <span class="number">100000000</span>,</span><br><span class="line">    gender: <span class="string">"Male"</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Println(<span class="string">"varEmployee is: "</span>, varEmployee)</span><br><span class="line">  varEmployee.Help()</span><br><span class="line">  fmt.Println(<span class="string">"varEmployee.name = "</span>, varEmployee.GetName())</span><br><span class="line">  fmt.Println(<span class="string">"varEmployee.age = "</span>, varEmployee.GetAge())</span><br><span class="line">  fmt.Println(<span class="string">"varEmployee.salary = "</span>, varEmployee.GetSalary())</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 匿名接口对象的使用</span></span><br><span class="line">  varMan := Man&#123;&amp;Employee&#123;</span><br><span class="line">    name:   <span class="string">"Nobody"</span>,</span><br><span class="line">    age:    <span class="number">20</span>,</span><br><span class="line">    salary: <span class="number">10000</span>,</span><br><span class="line">    gender: <span class="string">"Unknown"</span>,</span><br><span class="line">  &#125;&#125;</span><br><span class="line">  fmt.Println(<span class="string">"The gender of Nobody is: "</span>, varMan.gender.GetGender())</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 接口类型转换，从超集到子集的转换是可以的</span></span><br><span class="line">  <span class="comment">// 从方法集的子集到超集的转换会导致编译错误</span></span><br><span class="line">  <span class="comment">// 这种情况下 switch 不支持 fallthrough</span></span><br><span class="line">  <span class="keyword">var</span> varEmpInter EmployeeGetter = &amp;varEmployee</span><br><span class="line">  <span class="keyword">switch</span> varEmpInter.(<span class="keyword">type</span>) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="constant">nil</span>:</span><br><span class="line">    fmt.Println(<span class="string">"nil"</span>)</span><br><span class="line">  <span class="keyword">case</span> PeopleGetter:</span><br><span class="line">    fmt.Println(<span class="string">"PeopleGetter"</span>)</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    fmt.Println(<span class="string">"Unknown"</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 使用 “执行回调函数的接口对象” 执行回调函数</span></span><br><span class="line">  <span class="comment">// 这种做法的优势是函数显式地 “实现” 特定接口</span></span><br><span class="line">  varCallbacker := CallbackFunc(<span class="keyword">func</span>() &#123; <span class="built_in">println</span>(<span class="string">"I am a callback function."</span>) &#125;)</span><br><span class="line">  varCallbacker.Execute()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go run ex14.go</span><br><span class="line">varEmptyInterface is of <span class="built_in">type</span> &lt;nil&gt;</span><br><span class="line">varEmptyInterface is of <span class="built_in">type</span> int</span><br><span class="line">varEmptyInterface is of <span class="built_in">type</span> string</span><br><span class="line">varEmployee is:  &#123;Jack Ma <span class="number">50</span> <span class="number">100000000</span> Male&#125;</span><br><span class="line">This is <span class="built_in">help</span> info.</span><br><span class="line">varEmployee.name =  Jack Ma</span><br><span class="line">varEmployee.age =  <span class="number">50</span></span><br><span class="line">varEmployee.salary =  <span class="number">100000000</span></span><br><span class="line">The gender of Nobody is:  Unknown</span><br><span class="line">PeopleGetter</span><br><span class="line">I am a callback function.</span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong></p>
<ul>
<li>interface 的定义和使用</li>
</ul>
<h2 id="u603B_u7ED3"><a href="#u603B_u7ED3" class="headerlink" title="总结"></a>总结</h2><p>本文通过 14 个简单的例子来说明了 Go 的基本用法，如果能大致理解，就可以开始具体的探险了，让我们边学边练，搞一个练手项目吧。</p>
<h2 id="u53C2_u8003_u94FE_u63A5"><a href="#u53C2_u8003_u94FE_u63A5" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a href="https://github.com/wdxtub/learn-go-the-hard-way" target="_blank" rel="external">配套代码</a></li>
<li><a href="http://xhrwang.me/2014/12/30/golang-fundamentals-9-error-panic-recover.html" target="_blank" rel="external">Golang 语言基础之九： error, panic, recover</a></li>
</ul>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>感觉如何？</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/misc/wechat.jpg" alt="wdxtub WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
    </div>
  </div>


      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Go/" rel="tag">#Go</a>
          
            <a href="/tags/笨鸟/" rel="tag">#笨鸟</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/08/15/kafka-guide/" rel="next" title="Kafka 指南">
                <i class="fa fa-chevron-left"></i> Kafka 指南
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/08/16/how-to-teach-cs/" rel="prev" title="我们需要怎样的计算机科学教育">
                我们需要怎样的计算机科学教育 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/08/15/learn-go-the-hard-way/"
           data-title="【Go 之旅】II 我的笨办法学 Go" data-url="http://wdxtub.com/2016/08/15/learn-go-the-hard-way/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/misc/avatar.jpg"
               alt="wdxtub" />
          <p class="site-author-name" itemprop="name">wdxtub</p>
          <p class="site-description motion-element" itemprop="description">一个逗比的碎碎念</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">610</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">845</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/wdxtub" target="_blank" title="GitHub">
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/wdxtub" target="_blank" title="微博">
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://douban.com/people/wdx" target="_blank" title="豆瓣">
                  
                  豆瓣
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/wdxtub" target="_blank" title="知乎">
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              不妨看看
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://zhchbin.github.io/" title="zhchbin" target="_blank">zhchbin</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.algorithmdog.com/" title="算法狗" target="_blank">算法狗</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.52cs.org/" title="我爱计算机" target="_blank">我爱计算机</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://jackqdyulei.github.io/" title="雷雷" target="_blank">雷雷</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://guojiex.github.io/" title="瓜瓜" target="_blank">瓜瓜</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://wdxtub.lofter.com/" title="我的 Lofter" target="_blank">我的 Lofter</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://wdxtub.com/interview/" title="刷题笔记" target="_blank">刷题笔记</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#u5F00_u59CB_u4E4B_u524D"><span class="nav-number">1.</span> <span class="nav-text">开始之前</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_1__u7B2C_u4E00_u4E2A_u7A0B_u5E8F"><span class="nav-number">2.</span> <span class="nav-text">习题 1 第一个程序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_2__u6570_u5B57_u548C_u6570_u5B66_u8FD0_u7B97"><span class="nav-number">3.</span> <span class="nav-text">习题 2 数字和数学运算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_3__u8F93_u5165_u8F93_u51FA"><span class="nav-number">4.</span> <span class="nav-text">习题 3 输入输出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_4__u547D_u4EE4_u884C_u53C2_u6570"><span class="nav-number">5.</span> <span class="nav-text">习题 4 命令行参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_5__u8BFB_u5199_u6587_u4EF6_u3001_u6761_u4EF6_u5224_u65AD_u548C_u51FD_u6570"><span class="nav-number">6.</span> <span class="nav-text">习题 5 读写文件、条件判断和函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_6__u679A_u4E3E_u7C7B_u578B"><span class="nav-number">7.</span> <span class="nav-text">习题 6 枚举类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_7__u503C_u4E0E_u5F15_u7528"><span class="nav-number">8.</span> <span class="nav-text">习题 7 值与引用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_8__u6570_u7EC4_u4E0E_u5207_u7247"><span class="nav-number">9.</span> <span class="nav-text">习题 8 数组与切片</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_9__u6620_u5C04"><span class="nav-number">10.</span> <span class="nav-text">习题 9 映射</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_10_Switch__u8BED_u53E5"><span class="nav-number">11.</span> <span class="nav-text">习题 10 Switch 语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_11__u5E76_u53D1"><span class="nav-number">12.</span> <span class="nav-text">习题 11 并发</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_12_Select__u8BED_u53E5"><span class="nav-number">13.</span> <span class="nav-text">习题 12 Select 语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_13__u9519_u8BEF_u4E0E_u5F02_u5E38"><span class="nav-number">14.</span> <span class="nav-text">习题 13 错误与异常</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u4E60_u9898_14_Interface"><span class="nav-number">15.</span> <span class="nav-text">习题 14 Interface</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u603B_u7ED3"><span class="nav-number">16.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u53C2_u8003_u94FE_u63A5"><span class="nav-number">17.</span> <span class="nav-text">参考链接</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wdxtub</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"wdxblog"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementById('footer')
      || document.getElementById('footer')).appendChild(ds);
    })();
  </script>

  
    
      
      <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
      <script src="/js/src/hook-duoshuo.js"></script>
    
  





  
  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  

  

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</body>
</html>
